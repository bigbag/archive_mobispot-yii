(function (a) {
	var slideHat = {};
	$('.slide-box-close').on("click", function () {
		$('.slide-box').slideUp(400, function () {
			$('.toggle-box').removeClass('open');
		});
	});
	a(function () {
		a(".toggle-box").on("click", function (b) {
			var c = a(b.currentTarget);
			var navButtonId = this.id;
			var $anotherButtons;
			var $formSlideButtons;

			$(this).hasClass('toggle-box__sub') ? $anotherButtons = $(this).siblings() : $anotherButtons = $('.nav-bar li a').not(this);
			$formSlideButtons =  $('.form-link');

			if ($anotherButtons.hasClass('open') || $formSlideButtons.hasClass('open') ) {
				slideHat.delay = 400;
				$anotherButtons.removeClass('open');
				$formSlideButtons.removeClass('open');
				$(this).hasClass('toggle-box__sub') ? $('.sub-slide-box').slideUp(400) : $('.slide-box').slideUp(400)
			}else{
				slideHat.delay = 0;
			}

			if (c.hasClass("open")) {
				c.hasClass('onlyOpen') || (c.removeClass("open"), a("#" + navButtonId + "Form").slideUp(400));
			} else {
				c.addClass("open"), a("#" + navButtonId + "Form").delay(slideHat.delay).slideDown(480, function(){
					slideHat.height = $('.m-page-hat').outerHeight();
				});
				if (c.hasClass('slideTo')) {
					$("html, body").animate({
						scrollTop: $($(this).attr("href")).offset().top + "px"
					});
				}
				if (c.hasClass('onlyOpen')) {
					$('.onlyOpen').not(c).removeClass('open').find(".slide-content").slideUp(400);
				}
			}

			return false;
		});
	});

	$('.toggle-box', '.header-page').click(function () {
		$('html, body').animate({
			scrollTop: 0
		}, 600);
	});


	$(document).on('click', function(){
		$('.slide-box').slideUp(400);
		$('a','.nav-bar').removeClass('open');
	});

	$(document).on('click','.m-page-hat', function(event){
		event.stopPropagation();
	});

	$(document).scroll(slideHat.height, function(){
		var $aNavBar = $('a','.nav-bar');
		 if( $($aNavBar).hasClass('open') ){
				var scrollTop = $(this).scrollTop();
				if (scrollTop > slideHat.height){
					var difference = scrollTop - slideHat.height;
					$('html, body').scrollTop(difference);
					$('.slide-box').css('display', 'none');
					$($aNavBar).removeClass('open');
				}
		 }
	});


})(jQuery);